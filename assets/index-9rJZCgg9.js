import{a as D,a1 as K,l as H,J as T,A as g,m as z,a4 as E,r as G,o as J,c as j,e,w as t,b as n,t as v,u as o,K as y,a5 as M,F as O,a6 as Q,a7 as p,a8 as S,a9 as W,i as X,E as Y,aa as Z,D as ee,ab as se,ac as te,ad as ae,ae as oe,G as le,af as re,ag as ne,_ as ie}from"./index-vpA-h1lW.js";import{v as ue}from"./validator-RQhN6wQS.js";const de=_=>(re("data-v-90a6bfee"),_=_(),ne(),_),pe={class:"form-title"},me={class:"remember"},ce={class:"other-login"},_e=de(()=>n("div",{class:"divider"},[n("span",{class:"line"}),n("span",{class:"divider-text"},"其它登录方式"),n("span",{class:"line"})],-1)),fe={class:"other-login-wrapper"},ge={class:"other-login-item"},ve={class:"other-login-item"},he={class:"other-login-item"},we=D({__name:"index",setup(_){const{t:b}=K(),$=H(),f=T();let h=g(),u=g(!0),m=g(!1),x=z(),w=g(),s=E({username:"",password:"",remember:!1,sliderPass:!1}),P=E({username:[{required:!0,message:b("validator.inputUsername"),trigger:"blur"}],password:[{required:!0,message:b("validator.inputPassword"),trigger:"blur"}],sliderPass:[{validator:ue,trigger:"blur"}]});const C=()=>{if(s.remember){if(s.password.trim()===""){let l=localStorage.getItem(s.username);l?(u.value=!1,s.password=Q(l)):u.value=!0}}else u.value=!0,s.password=""},F=()=>{s.remember=!1,u.value=!0},R=()=>{s.remember=!1,u.value=!0},V=l=>{l&&l.validate(async a=>{a?(m.value=!0,await x.userLogin(s).then(()=>{const r=$.query.redirect;f.push({path:r||"/"}),f.push("/"),p({title:`Hi，${S()}好 ⛅`,type:"success",message:"欢迎登录"}),s.remember?localStorage.setItem(s.username,W(s.password)):localStorage.removeItem(s.username),m.value=!1},r=>{r.code===210||r.code===211?p({title:"登录失败",type:"error",message:"账号或密码错误"}):p({title:"登录失败",type:"error",message:r.code+" "+r}),m.value=!1,s.sliderPass=!1,h.value.reset()})):(p({title:"表单校验失败",type:"error"}),m.value=!1,s.sliderPass=!1,h.value.reset())})},U=()=>{x.userLogin({username:"Visitor",password:"Visitor"}).then(()=>{f.push({path:"/"}),p({title:`Hi，${S()}好 ⛅`,type:"success",message:"欢迎登录",duration:1500})},l=>{p({title:"登录失败",type:"error",message:l})})};return(l,a)=>{const r=X,d=Y,I=Z,c=ee,q=se,L=te,B=G("router-link"),N=ae,k=oe,A=le;return J(),j(O,null,[e(A,{ref_key:"loginFormRef",ref:w,size:"large",model:o(s),rules:o(P),onKeyup:a[6]||(a[6]=M(i=>V(o(w)),["enter"]))},{default:t(()=>[n("div",pe,[n("span",null,v(l.$t("login.title")),1)]),e(c,{prop:"username"},{default:t(()=>[e(I,{type:"text",modelValue:o(s).username,"onUpdate:modelValue":a[0]||(a[0]=i=>o(s).username=i),placeholder:l.$t("login.username"),autocomplete:"off",clearable:"",onInput:F},{prefix:t(()=>[e(d,null,{default:t(()=>[e(r,{name:"User"})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),e(c,{prop:"password",style:{margin:"10px 0px"}},{default:t(()=>[e(I,{type:"password",modelValue:o(s).password,"onUpdate:modelValue":a[1]||(a[1]=i=>o(s).password=i),placeholder:l.$t("login.password"),autocomplete:"off","show-password":o(u),clearable:"",onInput:R},{prefix:t(()=>[e(d,null,{default:t(()=>[e(r,{name:"Lock"})]),_:1})]),_:1},8,["modelValue","placeholder","show-password"])]),_:1}),n("div",me,[e(q,{label:"自动登录",modelValue:o(s).remember,"onUpdate:modelValue":a[2]||(a[2]=i=>o(s).remember=i),onChange:C},null,8,["modelValue"]),e(B,{replace:"",to:"/account/forget"},{default:t(()=>[e(L,{underline:!1,type:"primary"},{default:t(()=>[y(v(l.$t("login.forget")),1)]),_:1})]),_:1})]),e(c,{prop:"sliderPass"},{default:t(()=>[e(N,{ref_key:"slideVerifyRef",ref:h,value:o(s).sliderPass,"onUpdate:value":a[3]||(a[3]=i=>o(s).sliderPass=i)},null,8,["value"])]),_:1}),e(c,null,{default:t(()=>[e(k,{class:"form-button",type:"primary",loading:o(m),onClick:a[4]||(a[4]=i=>V(o(w)))},{default:t(()=>[y(v(l.$t("login.login")),1)]),_:1},8,["loading"])]),_:1}),e(c,null,{default:t(()=>[e(k,{class:"form-button",onClick:a[5]||(a[5]=i=>o(f).push("/account/signup"))},{default:t(()=>[y(v(l.$t("login.signup")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"]),n("div",ce,[_e,n("div",fe,[n("div",{title:"访客登录",class:"other-login-item",onClick:U},[e(d,{class:"other-login-icon"},{default:t(()=>[e(r,{name:"visitor",width:"33px",height:"33px"})]),_:1})]),n("div",ge,[e(d,null,{default:t(()=>[e(r,{name:"wechat",width:"33px",height:"33px"})]),_:1})]),n("div",ve,[e(d,null,{default:t(()=>[e(r,{name:"qq",width:"33px",height:"33px"})]),_:1})]),n("div",he,[e(d,null,{default:t(()=>[e(r,{name:"alipay",width:"33px",height:"33px"})]),_:1})])])])],64)}}}),xe=ie(we,[["__scopeId","data-v-90a6bfee"]]);export{xe as default};
